services:
  master:
    image: localhost:5000/db
    build: ./db/
    container_name: master
    volumes:
      - ./db/master_data:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: deb
      POSTGRES_DB: db
  slave:
    image: localhost:5000/db_repl
    build: ./db_repl/
    container_name: slave
    volumes:
      - ./db_repl/slave_data:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: replication
      POSTGRES_PASSWORD: deb
      PGUSER: replication
      PGPASSWORD: deb
      PGDATABASE: db
    depends_on:
      - master

  bot:
    image: localhost:5000/bot
    build: ./bot/
    env_file: .env
    container_name: bot
    restart: always
